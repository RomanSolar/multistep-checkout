/**
 * @template S
 * @typedef {[S, React.Dispatch<React.SetStateAction<S>>]} State
 */

/**
 * @param {Object} props
 * @param {string=} props.type
 * @param {string} props.label
 * @param {string=} props.id
 * @param {string=} props.min
 * @param {string=} props.max
 * @param {State<string>} props.state
 */
const TextInput = ({
  type,
  label,
  id,
  min,
  max,
  state: [get, set]
}) => {
  id = id || name.toLowerCase();
  const element = /*#__PURE__*/React.createElement("input", {
    type: type || 'text',
    id: id,
    name: id,
    autoComplete: id,
    value: get,
    onChange: event => set(event.target.value),
    min: min,
    max: max,
    required: true
  });
  return label ? /*#__PURE__*/React.createElement("tr", null, /*#__PURE__*/React.createElement("td", null, /*#__PURE__*/React.createElement("label", {
    for: id
  }, label)), /*#__PURE__*/React.createElement("td", null, element)) : element;
};
/**
 * @param {Object} props
 * @param {() => any} props.onSubmit
 * @param {State<number>} props.buttonLabel
 * @param {React.ReactChildren} props.children
 */


const FormPage = props => /*#__PURE__*/React.createElement("form", {
  onSubmit: event => {
    event.preventDefault();
    props.onSubmit();
  }
}, /*#__PURE__*/React.createElement("table", null, /*#__PURE__*/React.createElement("tbody", null, props.children, /*#__PURE__*/React.createElement("tr", null, /*#__PURE__*/React.createElement("td", null, /*#__PURE__*/React.createElement("input", {
  type: "submit",
  value: props.buttonLabel
}))))));
/**
 * @param {Object} props
 * @param {(Object) => any} props.onSubmit
 */


const F1 = props => {
  const name = React.useState('');
  const email = React.useState('');
  const password = React.useState('');

  const submit = () => props.onSubmit({
    name,
    email,
    password
  });

  return /*#__PURE__*/React.createElement(FormPage, {
    buttonLabel: "Next",
    onSubmit: submit
  }, /*#__PURE__*/React.createElement(TextInput, {
    label: "Name",
    state: name
  }), /*#__PURE__*/React.createElement(TextInput, {
    label: "Email",
    type: "email",
    state: email
  }), /*#__PURE__*/React.createElement(TextInput, {
    type: "password",
    label: "Password",
    id: "new-password",
    state: password
  }));
};
/**
 * @param {Object} props
 * @param {number} props.id
 * @param {(Object) => any} props.onSubmit
 */


const F2 = props => {
  const line1 = React.useState('');
  const line2 = React.useState('');
  const city = React.useState('');
  const state = React.useState('');
  const zipcode = React.useState('');
  const phone = React.useState('');

  const submit = () => props.onSubmit({
    id: [props.id],
    line1,
    line2,
    city,
    state,
    zipcode,
    phone
  });

  return /*#__PURE__*/React.createElement(FormPage, {
    buttonLabel: "Next",
    onSubmit: submit
  }, /*#__PURE__*/React.createElement(TextInput, {
    label: "Address Line 1",
    id: "address-line1",
    state: line1
  }), /*#__PURE__*/React.createElement(TextInput, {
    label: "Address Line 2",
    id: "address-line2",
    state: line2
  }), /*#__PURE__*/React.createElement(TextInput, {
    label: "City",
    id: "address-level2",
    state: city
  }), /*#__PURE__*/React.createElement(TextInput, {
    label: "State",
    id: "address-level1",
    state: state
  }), /*#__PURE__*/React.createElement(TextInput, {
    label: "ZIP Code",
    id: "postal-code",
    state: zipcode
  }), /*#__PURE__*/React.createElement(TextInput, {
    label: "Phone",
    type: "tel",
    state: phone
  }));
};

const currentYear = new Date().getFullYear().toString();
/**
 * @param {Object} props
 * @param {number} props.id
 * @param {(Object) => any} props.onSubmit
 */

const F3 = props => {
  const ccNumber = React.useState('');
  const ccMonth = React.useState('1');
  const ccYear = React.useState(currentYear);
  const ccCVV = React.useState('');
  const ccZipcode = React.useState('');

  const submit = () => props.onSubmit({
    id: [props.id],
    ccNumber,
    ccExpiry: [new Date(ccYear[0], ccMonth[0])],
    ccCVV,
    ccZipcode
  });

  return /*#__PURE__*/React.createElement(FormPage, {
    buttonLabel: "Checkout",
    onSubmit: submit
  }, /*#__PURE__*/React.createElement(TextInput, {
    label: "Credit Card",
    type: "number",
    id: "cc-number",
    max: "9999999999999999",
    state: ccNumber
  }), /*#__PURE__*/React.createElement("tr", null, /*#__PURE__*/React.createElement("td", null, /*#__PURE__*/React.createElement("label", null, "Expiration Date")), /*#__PURE__*/React.createElement("td", null, /*#__PURE__*/React.createElement(TextInput, {
    type: "number",
    id: "cc-exp-month",
    min: "1",
    max: "12",
    state: ccMonth
  }), /*#__PURE__*/React.createElement(TextInput, {
    type: "number",
    id: "cc-exp-year",
    min: currentYear,
    state: ccYear
  }))), /*#__PURE__*/React.createElement(TextInput, {
    label: "CVV",
    type: "number",
    id: "cc-csc",
    max: "999",
    state: ccCVV
  }), /*#__PURE__*/React.createElement(TextInput, {
    label: "Billing Address ZIP code",
    type: "number",
    id: "postal-code",
    max: "99999",
    state: ccZipcode
  }));
};

const App = () => {
  const [page, setPage] = React.useState(0);
  const [id, setId] = React.useState(null);

  const update = form => {
    console.log(form);

    for (const key in form) {
      form[key] = form[key][0];
    }

    const req = new XMLHttpRequest();
    req.open('POST', '/', true);

    req.onload = event => {
      setId(Number(event.target.response));
      setPage(page => (page + 1) % 3);
    };

    req.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
    req.send(JSON.stringify(form));
  };

  if (page === 0) {
    return /*#__PURE__*/React.createElement(F1, {
      onSubmit: update
    });
  } else if (page === 1) {
    return /*#__PURE__*/React.createElement(F2, {
      onSubmit: update,
      id: id
    });
  } else {
    return /*#__PURE__*/React.createElement(F3, {
      onSubmit: update,
      id: id
    });
  }
};

ReactDOM.render( /*#__PURE__*/React.createElement(App, null), document.getElementById('app'));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2NsaWVudC9hcHAuanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sU0FBUyxHQUFHLENBQUM7QUFBQyxFQUFBLElBQUQ7QUFBTyxFQUFBLEtBQVA7QUFBYyxFQUFBLEVBQWQ7QUFBa0IsRUFBQSxHQUFsQjtBQUF1QixFQUFBLEdBQXZCO0FBQTRCLEVBQUEsS0FBSyxFQUFFLENBQUMsR0FBRCxFQUFNLEdBQU47QUFBbkMsQ0FBRCxLQUFvRDtBQUNwRSxFQUFBLEVBQUUsR0FBRyxFQUFFLElBQUksSUFBSSxDQUFDLFdBQUwsRUFBWDtBQUNBLFFBQU0sT0FBTyxnQkFDWDtBQUNFLElBQUEsSUFBSSxFQUFFLElBQUksSUFBSSxNQURoQjtBQUVFLElBQUEsRUFBRSxFQUFFLEVBRk47QUFHRSxJQUFBLElBQUksRUFBRSxFQUhSO0FBSUUsSUFBQSxZQUFZLEVBQUUsRUFKaEI7QUFLRSxJQUFBLEtBQUssRUFBRSxHQUxUO0FBTUUsSUFBQSxRQUFRLEVBQUcsS0FBRCxJQUFXLEdBQUcsQ0FBQyxLQUFLLENBQUMsTUFBTixDQUFhLEtBQWQsQ0FOMUI7QUFPRSxJQUFBLEdBQUcsRUFBRSxHQVBQO0FBUUUsSUFBQSxHQUFHLEVBQUUsR0FSUDtBQVNFLElBQUEsUUFBUTtBQVRWLElBREY7QUFhQSxTQUFPLEtBQUssZ0JBQ1YsNkNBQ0UsNkNBQ0U7QUFBTyxJQUFBLEdBQUcsRUFBRTtBQUFaLEtBQWlCLEtBQWpCLENBREYsQ0FERixlQUlFLGdDQUNHLE9BREgsQ0FKRixDQURVLEdBU1IsT0FUSjtBQVVELENBekJEO0FBMkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0EsTUFBTSxRQUFRLEdBQUksS0FBRCxpQkFDZjtBQUFNLEVBQUEsUUFBUSxFQUFHLEtBQUQsSUFBVztBQUFFLElBQUEsS0FBSyxDQUFDLGNBQU47QUFBd0IsSUFBQSxLQUFLLENBQUMsUUFBTjtBQUFtQjtBQUF4RSxnQkFDRSxnREFDRSxtQ0FDRyxLQUFLLENBQUMsUUFEVCxlQUVFLDZDQUNFLDZDQUNFO0FBQU8sRUFBQSxJQUFJLEVBQUMsUUFBWjtBQUFxQixFQUFBLEtBQUssRUFBRSxLQUFLLENBQUM7QUFBbEMsRUFERixDQURGLENBRkYsQ0FERixDQURGLENBREY7QUFlQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0EsTUFBTSxFQUFFLEdBQUksS0FBRCxJQUFXO0FBQ3BCLFFBQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxRQUFOLENBQWUsRUFBZixDQUFiO0FBQ0EsUUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLFFBQU4sQ0FBZSxFQUFmLENBQWQ7QUFDQSxRQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsUUFBTixDQUFlLEVBQWYsQ0FBakI7O0FBRUEsUUFBTSxNQUFNLEdBQUcsTUFBTSxLQUFLLENBQUMsUUFBTixDQUFlO0FBQ2xDLElBQUEsSUFEa0M7QUFFbEMsSUFBQSxLQUZrQztBQUdsQyxJQUFBO0FBSGtDLEdBQWYsQ0FBckI7O0FBTUEsc0JBQ0Usb0JBQUMsUUFBRDtBQUFVLElBQUEsV0FBVyxFQUFDLE1BQXRCO0FBQTZCLElBQUEsUUFBUSxFQUFFO0FBQXZDLGtCQUNFLG9CQUFDLFNBQUQ7QUFBVyxJQUFBLEtBQUssRUFBQyxNQUFqQjtBQUF3QixJQUFBLEtBQUssRUFBRTtBQUEvQixJQURGLGVBRUUsb0JBQUMsU0FBRDtBQUFXLElBQUEsS0FBSyxFQUFDLE9BQWpCO0FBQXlCLElBQUEsSUFBSSxFQUFDLE9BQTlCO0FBQXNDLElBQUEsS0FBSyxFQUFFO0FBQTdDLElBRkYsZUFHRSxvQkFBQyxTQUFEO0FBQ0UsSUFBQSxJQUFJLEVBQUMsVUFEUDtBQUVFLElBQUEsS0FBSyxFQUFDLFVBRlI7QUFHRSxJQUFBLEVBQUUsRUFBQyxjQUhMO0FBSUUsSUFBQSxLQUFLLEVBQUU7QUFKVCxJQUhGLENBREY7QUFZRCxDQXZCRDtBQXlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQSxNQUFNLEVBQUUsR0FBSSxLQUFELElBQVc7QUFDcEIsUUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLFFBQU4sQ0FBZSxFQUFmLENBQWQ7QUFDQSxRQUFNLEtBQUssR0FBRyxLQUFLLENBQUMsUUFBTixDQUFlLEVBQWYsQ0FBZDtBQUNBLFFBQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxRQUFOLENBQWUsRUFBZixDQUFiO0FBQ0EsUUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLFFBQU4sQ0FBZSxFQUFmLENBQWQ7QUFDQSxRQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsUUFBTixDQUFlLEVBQWYsQ0FBaEI7QUFDQSxRQUFNLEtBQUssR0FBRyxLQUFLLENBQUMsUUFBTixDQUFlLEVBQWYsQ0FBZDs7QUFFQSxRQUFNLE1BQU0sR0FBRyxNQUFNLEtBQUssQ0FBQyxRQUFOLENBQWU7QUFDbEMsSUFBQSxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBUCxDQUQ4QjtBQUVsQyxJQUFBLEtBRmtDO0FBR2xDLElBQUEsS0FIa0M7QUFJbEMsSUFBQSxJQUprQztBQUtsQyxJQUFBLEtBTGtDO0FBTWxDLElBQUEsT0FOa0M7QUFPbEMsSUFBQTtBQVBrQyxHQUFmLENBQXJCOztBQVVBLHNCQUNFLG9CQUFDLFFBQUQ7QUFBVSxJQUFBLFdBQVcsRUFBQyxNQUF0QjtBQUE2QixJQUFBLFFBQVEsRUFBRTtBQUF2QyxrQkFDRSxvQkFBQyxTQUFEO0FBQVcsSUFBQSxLQUFLLEVBQUMsZ0JBQWpCO0FBQWtDLElBQUEsRUFBRSxFQUFDLGVBQXJDO0FBQXFELElBQUEsS0FBSyxFQUFFO0FBQTVELElBREYsZUFFRSxvQkFBQyxTQUFEO0FBQVcsSUFBQSxLQUFLLEVBQUMsZ0JBQWpCO0FBQWtDLElBQUEsRUFBRSxFQUFDLGVBQXJDO0FBQXFELElBQUEsS0FBSyxFQUFFO0FBQTVELElBRkYsZUFHRSxvQkFBQyxTQUFEO0FBQVcsSUFBQSxLQUFLLEVBQUMsTUFBakI7QUFBd0IsSUFBQSxFQUFFLEVBQUMsZ0JBQTNCO0FBQTRDLElBQUEsS0FBSyxFQUFFO0FBQW5ELElBSEYsZUFJRSxvQkFBQyxTQUFEO0FBQVcsSUFBQSxLQUFLLEVBQUMsT0FBakI7QUFBeUIsSUFBQSxFQUFFLEVBQUMsZ0JBQTVCO0FBQTZDLElBQUEsS0FBSyxFQUFFO0FBQXBELElBSkYsZUFLRSxvQkFBQyxTQUFEO0FBQVcsSUFBQSxLQUFLLEVBQUMsVUFBakI7QUFBNEIsSUFBQSxFQUFFLEVBQUMsYUFBL0I7QUFBNkMsSUFBQSxLQUFLLEVBQUU7QUFBcEQsSUFMRixlQU1FLG9CQUFDLFNBQUQ7QUFBVyxJQUFBLEtBQUssRUFBQyxPQUFqQjtBQUF5QixJQUFBLElBQUksRUFBQyxLQUE5QjtBQUFvQyxJQUFBLEtBQUssRUFBRTtBQUEzQyxJQU5GLENBREY7QUFVRCxDQTVCRDs7QUE4QkEsTUFBTSxXQUFXLEdBQUcsSUFBSSxJQUFKLEdBQVcsV0FBWCxHQUF5QixRQUF6QixFQUFwQjtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0EsTUFBTSxFQUFFLEdBQUksS0FBRCxJQUFXO0FBQ3BCLFFBQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxRQUFOLENBQWUsRUFBZixDQUFqQjtBQUNBLFFBQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxRQUFOLENBQWUsR0FBZixDQUFoQjtBQUNBLFFBQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxRQUFOLENBQWUsV0FBZixDQUFmO0FBQ0EsUUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLFFBQU4sQ0FBZSxFQUFmLENBQWQ7QUFDQSxRQUFNLFNBQVMsR0FBRyxLQUFLLENBQUMsUUFBTixDQUFlLEVBQWYsQ0FBbEI7O0FBRUEsUUFBTSxNQUFNLEdBQUcsTUFBTSxLQUFLLENBQUMsUUFBTixDQUFlO0FBQ2xDLElBQUEsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQVAsQ0FEOEI7QUFFbEMsSUFBQSxRQUZrQztBQUdsQyxJQUFBLFFBQVEsRUFBRSxDQUFDLElBQUksSUFBSixDQUFTLE1BQU0sQ0FBQyxDQUFELENBQWYsRUFBb0IsT0FBTyxDQUFDLENBQUQsQ0FBM0IsQ0FBRCxDQUh3QjtBQUlsQyxJQUFBLEtBSmtDO0FBS2xDLElBQUE7QUFMa0MsR0FBZixDQUFyQjs7QUFRQSxzQkFDRSxvQkFBQyxRQUFEO0FBQVUsSUFBQSxXQUFXLEVBQUMsVUFBdEI7QUFBaUMsSUFBQSxRQUFRLEVBQUU7QUFBM0Msa0JBQ0Usb0JBQUMsU0FBRDtBQUNFLElBQUEsS0FBSyxFQUFDLGFBRFI7QUFFRSxJQUFBLElBQUksRUFBQyxRQUZQO0FBR0UsSUFBQSxFQUFFLEVBQUMsV0FITDtBQUlFLElBQUEsR0FBRyxFQUFDLGtCQUpOO0FBS0UsSUFBQSxLQUFLLEVBQUU7QUFMVCxJQURGLGVBUUUsNkNBQ0UsNkNBQ0UscURBREYsQ0FERixlQUlFLDZDQUNFLG9CQUFDLFNBQUQ7QUFDRSxJQUFBLElBQUksRUFBQyxRQURQO0FBRUUsSUFBQSxFQUFFLEVBQUMsY0FGTDtBQUdFLElBQUEsR0FBRyxFQUFDLEdBSE47QUFJRSxJQUFBLEdBQUcsRUFBQyxJQUpOO0FBS0UsSUFBQSxLQUFLLEVBQUU7QUFMVCxJQURGLGVBUUUsb0JBQUMsU0FBRDtBQUNFLElBQUEsSUFBSSxFQUFDLFFBRFA7QUFFRSxJQUFBLEVBQUUsRUFBQyxhQUZMO0FBR0UsSUFBQSxHQUFHLEVBQUUsV0FIUDtBQUlFLElBQUEsS0FBSyxFQUFFO0FBSlQsSUFSRixDQUpGLENBUkYsZUE0QkUsb0JBQUMsU0FBRDtBQUNFLElBQUEsS0FBSyxFQUFDLEtBRFI7QUFFRSxJQUFBLElBQUksRUFBQyxRQUZQO0FBR0UsSUFBQSxFQUFFLEVBQUMsUUFITDtBQUlFLElBQUEsR0FBRyxFQUFDLEtBSk47QUFLRSxJQUFBLEtBQUssRUFBRTtBQUxULElBNUJGLGVBbUNFLG9CQUFDLFNBQUQ7QUFDRSxJQUFBLEtBQUssRUFBQywwQkFEUjtBQUVFLElBQUEsSUFBSSxFQUFDLFFBRlA7QUFHRSxJQUFBLEVBQUUsRUFBQyxhQUhMO0FBSUUsSUFBQSxHQUFHLEVBQUMsT0FKTjtBQUtFLElBQUEsS0FBSyxFQUFFO0FBTFQsSUFuQ0YsQ0FERjtBQTZDRCxDQTVERDs7QUE4REEsTUFBTSxHQUFHLEdBQUcsTUFBTTtBQUNoQixRQUFNLENBQUMsSUFBRCxFQUFPLE9BQVAsSUFBa0IsS0FBSyxDQUFDLFFBQU4sQ0FBZSxDQUFmLENBQXhCO0FBQ0EsUUFBTSxDQUFDLEVBQUQsRUFBSyxLQUFMLElBQWMsS0FBSyxDQUFDLFFBQU4sQ0FBZSxJQUFmLENBQXBCOztBQUVBLFFBQU0sTUFBTSxHQUFJLElBQUQsSUFBVTtBQUN2QixJQUFBLE9BQU8sQ0FBQyxHQUFSLENBQVksSUFBWjs7QUFDQSxTQUFLLE1BQU0sR0FBWCxJQUFrQixJQUFsQixFQUF3QjtBQUN0QixNQUFBLElBQUksQ0FBQyxHQUFELENBQUosR0FBWSxJQUFJLENBQUMsR0FBRCxDQUFKLENBQVUsQ0FBVixDQUFaO0FBQ0Q7O0FBQ0QsVUFBTSxHQUFHLEdBQUcsSUFBSSxjQUFKLEVBQVo7QUFDQSxJQUFBLEdBQUcsQ0FBQyxJQUFKLENBQVMsTUFBVCxFQUFpQixHQUFqQixFQUFzQixJQUF0Qjs7QUFDQSxJQUFBLEdBQUcsQ0FBQyxNQUFKLEdBQWMsS0FBRCxJQUFXO0FBQ3RCLE1BQUEsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTixDQUFhLFFBQWQsQ0FBUCxDQUFMO0FBQ0EsTUFBQSxPQUFPLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxHQUFHLENBQVIsSUFBYSxDQUF0QixDQUFQO0FBQ0QsS0FIRDs7QUFJQSxJQUFBLEdBQUcsQ0FBQyxnQkFBSixDQUFxQixjQUFyQixFQUFxQyxnQ0FBckM7QUFDQSxJQUFBLEdBQUcsQ0FBQyxJQUFKLENBQVMsSUFBSSxDQUFDLFNBQUwsQ0FBZSxJQUFmLENBQVQ7QUFDRCxHQWJEOztBQWVBLE1BQUksSUFBSSxLQUFLLENBQWIsRUFBZ0I7QUFDZCx3QkFDRSxvQkFBQyxFQUFEO0FBQUksTUFBQSxRQUFRLEVBQUU7QUFBZCxNQURGO0FBR0QsR0FKRCxNQUlPLElBQUksSUFBSSxLQUFLLENBQWIsRUFBZ0I7QUFDckIsd0JBQ0Usb0JBQUMsRUFBRDtBQUFJLE1BQUEsUUFBUSxFQUFFLE1BQWQ7QUFBc0IsTUFBQSxFQUFFLEVBQUU7QUFBMUIsTUFERjtBQUdELEdBSk0sTUFJQTtBQUNMLHdCQUNFLG9CQUFDLEVBQUQ7QUFBSSxNQUFBLFFBQVEsRUFBRSxNQUFkO0FBQXNCLE1BQUEsRUFBRSxFQUFFO0FBQTFCLE1BREY7QUFHRDtBQUNGLENBaENEOztBQWtDQSxRQUFRLENBQUMsTUFBVCxlQUFnQixvQkFBQyxHQUFELE9BQWhCLEVBQXlCLFFBQVEsQ0FBQyxjQUFULENBQXdCLEtBQXhCLENBQXpCIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAdGVtcGxhdGUgU1xuICogQHR5cGVkZWYge1tTLCBSZWFjdC5EaXNwYXRjaDxSZWFjdC5TZXRTdGF0ZUFjdGlvbjxTPj5dfSBTdGF0ZVxuICovXG5cbi8qKlxuICogQHBhcmFtIHtPYmplY3R9IHByb3BzXG4gKiBAcGFyYW0ge3N0cmluZz19IHByb3BzLnR5cGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wcy5sYWJlbFxuICogQHBhcmFtIHtzdHJpbmc9fSBwcm9wcy5pZFxuICogQHBhcmFtIHtzdHJpbmc9fSBwcm9wcy5taW5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gcHJvcHMubWF4XG4gKiBAcGFyYW0ge1N0YXRlPHN0cmluZz59IHByb3BzLnN0YXRlXG4gKi9cbmNvbnN0IFRleHRJbnB1dCA9ICh7dHlwZSwgbGFiZWwsIGlkLCBtaW4sIG1heCwgc3RhdGU6IFtnZXQsIHNldF19KSA9PiB7XG4gIGlkID0gaWQgfHwgbmFtZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBlbGVtZW50ID0gKFxuICAgIDxpbnB1dFxuICAgICAgdHlwZT17dHlwZSB8fCAndGV4dCd9XG4gICAgICBpZD17aWR9XG4gICAgICBuYW1lPXtpZH1cbiAgICAgIGF1dG9Db21wbGV0ZT17aWR9XG4gICAgICB2YWx1ZT17Z2V0fVxuICAgICAgb25DaGFuZ2U9eyhldmVudCkgPT4gc2V0KGV2ZW50LnRhcmdldC52YWx1ZSl9XG4gICAgICBtaW49e21pbn1cbiAgICAgIG1heD17bWF4fVxuICAgICAgcmVxdWlyZWRcbiAgICAvPlxuICApO1xuICByZXR1cm4gbGFiZWwgPyAoXG4gICAgPHRyPlxuICAgICAgPHRkPlxuICAgICAgICA8bGFiZWwgZm9yPXtpZH0+e2xhYmVsfTwvbGFiZWw+XG4gICAgICA8L3RkPlxuICAgICAgPHRkPlxuICAgICAgICB7ZWxlbWVudH1cbiAgICAgIDwvdGQ+XG4gICAgPC90cj5cbiAgKSA6IGVsZW1lbnQ7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wc1xuICogQHBhcmFtIHsoKSA9PiBhbnl9IHByb3BzLm9uU3VibWl0XG4gKiBAcGFyYW0ge1N0YXRlPG51bWJlcj59IHByb3BzLmJ1dHRvbkxhYmVsXG4gKiBAcGFyYW0ge1JlYWN0LlJlYWN0Q2hpbGRyZW59IHByb3BzLmNoaWxkcmVuXG4gKi9cbmNvbnN0IEZvcm1QYWdlID0gKHByb3BzKSA9PiAoXG4gIDxmb3JtIG9uU3VibWl0PXsoZXZlbnQpID0+IHsgZXZlbnQucHJldmVudERlZmF1bHQoKTsgcHJvcHMub25TdWJtaXQoKTsgfX0+XG4gICAgPHRhYmxlPlxuICAgICAgPHRib2R5PlxuICAgICAgICB7cHJvcHMuY2hpbGRyZW59XG4gICAgICAgIDx0cj5cbiAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInN1Ym1pdFwiIHZhbHVlPXtwcm9wcy5idXR0b25MYWJlbH0vPlxuICAgICAgICAgIDwvdGQ+XG4gICAgICAgIDwvdHI+XG4gICAgICA8L3Rib2R5PlxuICAgIDwvdGFibGU+XG4gIDwvZm9ybT5cbik7XG5cbi8qKlxuICogQHBhcmFtIHtPYmplY3R9IHByb3BzXG4gKiBAcGFyYW0geyhPYmplY3QpID0+IGFueX0gcHJvcHMub25TdWJtaXRcbiAqL1xuY29uc3QgRjEgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgbmFtZSA9IFJlYWN0LnVzZVN0YXRlKCcnKTtcbiAgY29uc3QgZW1haWwgPSBSZWFjdC51c2VTdGF0ZSgnJyk7XG4gIGNvbnN0IHBhc3N3b3JkID0gUmVhY3QudXNlU3RhdGUoJycpO1xuXG4gIGNvbnN0IHN1Ym1pdCA9ICgpID0+IHByb3BzLm9uU3VibWl0KHtcbiAgICBuYW1lLFxuICAgIGVtYWlsLFxuICAgIHBhc3N3b3JkXG4gIH0pO1xuXG4gIHJldHVybiAoXG4gICAgPEZvcm1QYWdlIGJ1dHRvbkxhYmVsPSdOZXh0JyBvblN1Ym1pdD17c3VibWl0fT5cbiAgICAgIDxUZXh0SW5wdXQgbGFiZWw9J05hbWUnIHN0YXRlPXtuYW1lfS8+XG4gICAgICA8VGV4dElucHV0IGxhYmVsPSdFbWFpbCcgdHlwZT0nZW1haWwnIHN0YXRlPXtlbWFpbH0vPlxuICAgICAgPFRleHRJbnB1dFxuICAgICAgICB0eXBlPSdwYXNzd29yZCdcbiAgICAgICAgbGFiZWw9J1Bhc3N3b3JkJ1xuICAgICAgICBpZD0nbmV3LXBhc3N3b3JkJ1xuICAgICAgICBzdGF0ZT17cGFzc3dvcmR9XG4gICAgICAvPlxuICAgIDwvRm9ybVBhZ2U+XG4gICk7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wc1xuICogQHBhcmFtIHtudW1iZXJ9IHByb3BzLmlkXG4gKiBAcGFyYW0geyhPYmplY3QpID0+IGFueX0gcHJvcHMub25TdWJtaXRcbiAqL1xuY29uc3QgRjIgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgbGluZTEgPSBSZWFjdC51c2VTdGF0ZSgnJyk7XG4gIGNvbnN0IGxpbmUyID0gUmVhY3QudXNlU3RhdGUoJycpO1xuICBjb25zdCBjaXR5ID0gUmVhY3QudXNlU3RhdGUoJycpO1xuICBjb25zdCBzdGF0ZSA9IFJlYWN0LnVzZVN0YXRlKCcnKTtcbiAgY29uc3QgemlwY29kZSA9IFJlYWN0LnVzZVN0YXRlKCcnKTtcbiAgY29uc3QgcGhvbmUgPSBSZWFjdC51c2VTdGF0ZSgnJyk7XG5cbiAgY29uc3Qgc3VibWl0ID0gKCkgPT4gcHJvcHMub25TdWJtaXQoe1xuICAgIGlkOiBbcHJvcHMuaWRdLFxuICAgIGxpbmUxLFxuICAgIGxpbmUyLFxuICAgIGNpdHksXG4gICAgc3RhdGUsXG4gICAgemlwY29kZSxcbiAgICBwaG9uZVxuICB9KTtcblxuICByZXR1cm4gKFxuICAgIDxGb3JtUGFnZSBidXR0b25MYWJlbD0nTmV4dCcgb25TdWJtaXQ9e3N1Ym1pdH0+XG4gICAgICA8VGV4dElucHV0IGxhYmVsPSdBZGRyZXNzIExpbmUgMScgaWQ9J2FkZHJlc3MtbGluZTEnIHN0YXRlPXtsaW5lMX0vPlxuICAgICAgPFRleHRJbnB1dCBsYWJlbD0nQWRkcmVzcyBMaW5lIDInIGlkPSdhZGRyZXNzLWxpbmUyJyBzdGF0ZT17bGluZTJ9Lz5cbiAgICAgIDxUZXh0SW5wdXQgbGFiZWw9J0NpdHknIGlkPSdhZGRyZXNzLWxldmVsMicgc3RhdGU9e2NpdHl9Lz5cbiAgICAgIDxUZXh0SW5wdXQgbGFiZWw9J1N0YXRlJyBpZD0nYWRkcmVzcy1sZXZlbDEnIHN0YXRlPXtzdGF0ZX0vPlxuICAgICAgPFRleHRJbnB1dCBsYWJlbD0nWklQIENvZGUnIGlkPSdwb3N0YWwtY29kZScgc3RhdGU9e3ppcGNvZGV9Lz5cbiAgICAgIDxUZXh0SW5wdXQgbGFiZWw9J1Bob25lJyB0eXBlPSd0ZWwnIHN0YXRlPXtwaG9uZX0vPlxuICAgIDwvRm9ybVBhZ2U+XG4gICk7XG59O1xuXG5jb25zdCBjdXJyZW50WWVhciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpO1xuXG4vKipcbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wc1xuICogQHBhcmFtIHtudW1iZXJ9IHByb3BzLmlkXG4gKiBAcGFyYW0geyhPYmplY3QpID0+IGFueX0gcHJvcHMub25TdWJtaXRcbiAqL1xuY29uc3QgRjMgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgY2NOdW1iZXIgPSBSZWFjdC51c2VTdGF0ZSgnJyk7XG4gIGNvbnN0IGNjTW9udGggPSBSZWFjdC51c2VTdGF0ZSgnMScpO1xuICBjb25zdCBjY1llYXIgPSBSZWFjdC51c2VTdGF0ZShjdXJyZW50WWVhcik7XG4gIGNvbnN0IGNjQ1ZWID0gUmVhY3QudXNlU3RhdGUoJycpO1xuICBjb25zdCBjY1ppcGNvZGUgPSBSZWFjdC51c2VTdGF0ZSgnJyk7XG5cbiAgY29uc3Qgc3VibWl0ID0gKCkgPT4gcHJvcHMub25TdWJtaXQoe1xuICAgIGlkOiBbcHJvcHMuaWRdLFxuICAgIGNjTnVtYmVyLFxuICAgIGNjRXhwaXJ5OiBbbmV3IERhdGUoY2NZZWFyWzBdLCBjY01vbnRoWzBdKV0sXG4gICAgY2NDVlYsXG4gICAgY2NaaXBjb2RlXG4gIH0pO1xuXG4gIHJldHVybiAoXG4gICAgPEZvcm1QYWdlIGJ1dHRvbkxhYmVsPSdDaGVja291dCcgb25TdWJtaXQ9e3N1Ym1pdH0+XG4gICAgICA8VGV4dElucHV0XG4gICAgICAgIGxhYmVsPSdDcmVkaXQgQ2FyZCdcbiAgICAgICAgdHlwZT0nbnVtYmVyJ1xuICAgICAgICBpZD0nY2MtbnVtYmVyJ1xuICAgICAgICBtYXg9Jzk5OTk5OTk5OTk5OTk5OTknXG4gICAgICAgIHN0YXRlPXtjY051bWJlcn1cbiAgICAgIC8+XG4gICAgICA8dHI+XG4gICAgICAgIDx0ZD5cbiAgICAgICAgICA8bGFiZWw+RXhwaXJhdGlvbiBEYXRlPC9sYWJlbD5cbiAgICAgICAgPC90ZD5cbiAgICAgICAgPHRkPlxuICAgICAgICAgIDxUZXh0SW5wdXRcbiAgICAgICAgICAgIHR5cGU9J251bWJlcidcbiAgICAgICAgICAgIGlkPSdjYy1leHAtbW9udGgnXG4gICAgICAgICAgICBtaW49JzEnXG4gICAgICAgICAgICBtYXg9JzEyJ1xuICAgICAgICAgICAgc3RhdGU9e2NjTW9udGh9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8VGV4dElucHV0XG4gICAgICAgICAgICB0eXBlPSdudW1iZXInXG4gICAgICAgICAgICBpZD0nY2MtZXhwLXllYXInXG4gICAgICAgICAgICBtaW49e2N1cnJlbnRZZWFyfVxuICAgICAgICAgICAgc3RhdGU9e2NjWWVhcn1cbiAgICAgICAgICAvPlxuICAgICAgICA8L3RkPlxuICAgICAgPC90cj5cbiAgICAgIDxUZXh0SW5wdXRcbiAgICAgICAgbGFiZWw9J0NWVidcbiAgICAgICAgdHlwZT0nbnVtYmVyJ1xuICAgICAgICBpZD0nY2MtY3NjJ1xuICAgICAgICBtYXg9Jzk5OSdcbiAgICAgICAgc3RhdGU9e2NjQ1ZWfVxuICAgICAgLz5cbiAgICAgIDxUZXh0SW5wdXRcbiAgICAgICAgbGFiZWw9J0JpbGxpbmcgQWRkcmVzcyBaSVAgY29kZSdcbiAgICAgICAgdHlwZT0nbnVtYmVyJ1xuICAgICAgICBpZD0ncG9zdGFsLWNvZGUnXG4gICAgICAgIG1heD0nOTk5OTknXG4gICAgICAgIHN0YXRlPXtjY1ppcGNvZGV9XG4gICAgICAvPlxuICAgIDwvRm9ybVBhZ2U+XG4gICk7XG59O1xuXG5jb25zdCBBcHAgPSAoKSA9PiB7XG4gIGNvbnN0IFtwYWdlLCBzZXRQYWdlXSA9IFJlYWN0LnVzZVN0YXRlKDApO1xuICBjb25zdCBbaWQsIHNldElkXSA9IFJlYWN0LnVzZVN0YXRlKG51bGwpO1xuXG4gIGNvbnN0IHVwZGF0ZSA9IChmb3JtKSA9PiB7XG4gICAgY29uc29sZS5sb2coZm9ybSk7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gZm9ybSkge1xuICAgICAgZm9ybVtrZXldID0gZm9ybVtrZXldWzBdO1xuICAgIH1cbiAgICBjb25zdCByZXEgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICByZXEub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7XG4gICAgcmVxLm9ubG9hZCA9IChldmVudCkgPT4ge1xuICAgICAgc2V0SWQoTnVtYmVyKGV2ZW50LnRhcmdldC5yZXNwb25zZSkpO1xuICAgICAgc2V0UGFnZShwYWdlID0+IChwYWdlICsgMSkgJSAzKTtcbiAgICB9O1xuICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04Jyk7XG4gICAgcmVxLnNlbmQoSlNPTi5zdHJpbmdpZnkoZm9ybSkpO1xuICB9O1xuXG4gIGlmIChwYWdlID09PSAwKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxGMSBvblN1Ym1pdD17dXBkYXRlfS8+XG4gICAgKTtcbiAgfSBlbHNlIGlmIChwYWdlID09PSAxKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxGMiBvblN1Ym1pdD17dXBkYXRlfSBpZD17aWR9Lz5cbiAgICApO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiAoXG4gICAgICA8RjMgb25TdWJtaXQ9e3VwZGF0ZX0gaWQ9e2lkfS8+XG4gICAgKTtcbiAgfVxufTtcblxuUmVhY3RET00ucmVuZGVyKDxBcHAgLz4sIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHAnKSk7XG4iXX0=